<UserControl x:Class="CaseGraph.App.Views.Pages.DiagnosticsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{DynamicResource ContentBackgroundBrush}">
    <Grid Margin="{StaticResource Space16}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Diagnostics" Style="{StaticResource PageTitleTextStyle}" />

        <Border Grid.Row="1"
                Margin="{StaticResource SpaceTop12}"
                Style="{StaticResource PlaceholderHintBorderStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="12" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="8" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           VerticalAlignment="Center"
                           Style="{StaticResource BodyTextStyle}"
                           Text="Runtime diagnostics and workspace metadata." />

                <Button Grid.Column="2"
                        Content="Refresh"
                        Command="{Binding RefreshDiagnosticsCommand}"
                        Style="{StaticResource TopBarButtonStyle}" />

                <Button Grid.Column="4"
                        Content="Open Logs Folder"
                        Command="{Binding OpenLogsFolderCommand}"
                        Style="{StaticResource TopBarButtonStyle}" />

                <Button Grid.Column="6"
                        Content="Copy Diagnostics"
                        Command="{Binding CopyDiagnosticsCommand}"
                        Style="{StaticResource TopBarButtonStyle}" />

                <Button Grid.Column="8"
                        Content="Export Debug Bundle"
                        Command="{Binding ExportDebugBundleCommand}"
                        Style="{StaticResource TopBarButtonStyle}" />
            </Grid>
        </Border>

        <Grid Grid.Row="2" Margin="{StaticResource SpaceTop12}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="16" />
                <ColumnDefinition Width="1.4*" />
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource PlaceholderHintBorderStyle}">
                <StackPanel>
                    <TextBlock Text="Environment" Style="{StaticResource SectionTitleTextStyle}" />
                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Text="Previous session ended unexpectedly; export a debug bundle.">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock" BasedOn="{StaticResource BodyTextStyle}">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding DiagnosticsPreviousSessionEndedUnexpectedly}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="App Version" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsAppVersion}" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Git Commit" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsGitCommit}" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Workspace Root" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsWorkspaceRoot}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Workspace DB" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsWorkspaceDbPath}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Cases Root" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsCasesRoot}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Logs Directory" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsLogsDirectory}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Current Log Path" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsCurrentLogPath}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Crash Dumps Enabled" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsCrashDumpsEnabled}" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Dumps Directory" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsDumpsDirectory}"
                               TextWrapping="Wrap" />

                    <StackPanel Margin="{StaticResource SpaceTop12}"
                                Orientation="Horizontal">
                        <Button Content="Enable Dumps"
                                Command="{Binding EnableCrashDumpsCommand}"
                                Style="{StaticResource TopBarButtonStyle}" />
                        <Button Margin="8,0,0,0"
                                Content="Disable Dumps"
                                Command="{Binding DisableCrashDumpsCommand}"
                                Style="{StaticResource TopBarButtonStyle}" />
                        <Button Margin="8,0,0,0"
                                Content="Open Dumps Folder"
                                Command="{Binding OpenDumpsFolderCommand}"
                                Style="{StaticResource TopBarButtonStyle}" />
                    </StackPanel>

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Session Directory" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsSessionDirectory}"
                               TextWrapping="Wrap" />

                    <TextBlock Margin="{StaticResource SpaceTop12}"
                               Style="{StaticResource SecondaryBodyTextStyle}"
                               Text="Session Journal" />
                    <TextBlock Style="{StaticResource BodyTextStyle}"
                               Text="{Binding DiagnosticsSessionJournalPath}"
                               TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <Border Grid.Column="2" Style="{StaticResource PlaceholderHintBorderStyle}">
                <StackPanel>
                    <TextBlock Text="Last 50 Log Lines" Style="{StaticResource SectionTitleTextStyle}" />
                    <TextBox Margin="{StaticResource SpaceTop12}"
                             Text="{Binding DiagnosticsLastLogLinesText}"
                             IsReadOnly="True"
                             MinHeight="420"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             TextWrapping="NoWrap"
                             AcceptsReturn="True"
                             Style="{StaticResource TopBarTextBoxStyle}" />
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>
