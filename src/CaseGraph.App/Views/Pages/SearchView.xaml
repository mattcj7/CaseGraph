<UserControl x:Class="CaseGraph.App.Views.Pages.SearchView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{DynamicResource ContentBackgroundBrush}">
    <Grid Margin="{StaticResource Space16}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Message Search" Style="{StaticResource PageTitleTextStyle}" />

        <Border Grid.Row="1"
                Margin="{StaticResource SpaceTop12}"
                Style="{StaticResource PlaceholderHintBorderStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="16" />
                    <ColumnDefinition Width="220" />
                    <ColumnDefinition Width="16" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBox Grid.Column="0"
                         Text="{Binding MessageSearchQuery, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource TopBarTextBoxStyle}"
                         ToolTip="Search message body/sender/recipients" />

                <ComboBox Grid.Column="2"
                          ItemsSource="{Binding MessageSearchPlatformFilters}"
                          SelectedItem="{Binding SelectedMessageSearchPlatform, Mode=TwoWay}"
                          Style="{StaticResource TopBarComboBoxStyle}" />

                <Button Grid.Column="4"
                        Content="Search"
                        Command="{Binding SearchMessagesCommand}"
                        Style="{StaticResource TopBarButtonStyle}" />
            </Grid>
        </Border>

        <Grid Grid.Row="2" Margin="{StaticResource SpaceTop12}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="16" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <DataGrid Grid.Column="0"
                      ItemsSource="{Binding MessageSearchResults}"
                      SelectedItem="{Binding SelectedMessageSearchResult, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      IsReadOnly="True"
                      HeadersVisibility="Column">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Timestamp (UTC)" Binding="{Binding TimestampUtc, StringFormat={}{0:u}}" Width="1.5*" />
                    <DataGridTextColumn Header="Platform" Binding="{Binding Platform}" Width="*" />
                    <DataGridTextColumn Header="Sender" Binding="{Binding Sender}" Width="1.2*" />
                    <DataGridTextColumn Header="Snippet" Binding="{Binding Snippet}" Width="2.4*" />
                    <DataGridTextColumn Header="Thread" Binding="{Binding ThreadKey}" Width="1.3*" />
                </DataGrid.Columns>
            </DataGrid>

            <Border Grid.Column="2" Style="{StaticResource PlaceholderHintBorderStyle}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Selected Hit Details" Style="{StaticResource SectionTitleTextStyle}" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Status" />
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Text="{Binding MessageSearchStatusText}" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Evidence Item" />
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Text="{Binding SelectedMessageSearchResult.EvidenceDisplayName, TargetNullValue=(none)}"
                                   TextWrapping="Wrap" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Source Locator" />
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Text="{Binding SelectedMessageSearchResult.SourceLocator, TargetNullValue=(none)}"
                                   TextWrapping="Wrap" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Sender" />
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Text="{Binding SelectedMessageSearchResult.Sender, TargetNullValue=(none)}"
                                   TextWrapping="Wrap" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Recipients" />
                        <TextBlock Style="{StaticResource BodyTextStyle}"
                                   Text="{Binding SelectedMessageSearchResult.Recipients, TargetNullValue=(none)}"
                                   TextWrapping="Wrap" />

                        <TextBlock Margin="{StaticResource SpaceTop12}"
                                   Style="{StaticResource SecondaryBodyTextStyle}"
                                   Text="Body" />
                        <TextBox Text="{Binding SelectedMessageSearchResult.Body, TargetNullValue=(none)}"
                                 IsReadOnly="True"
                                 MinHeight="180"
                                 VerticalScrollBarVisibility="Auto"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Style="{StaticResource TopBarTextBoxStyle}" />

                        <Button Margin="{StaticResource SpaceTop16}"
                                Content="Copy Citation"
                                Command="{Binding CopyMessageCitationCommand}"
                                Style="{StaticResource TopBarButtonStyle}" />

                        <Button Margin="{StaticResource SpaceTop12}"
                                Content="View Stored Path (Copy)"
                                Command="{Binding CopyMessageStoredPathCommand}"
                                Style="{StaticResource TopBarButtonStyle}" />
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>
